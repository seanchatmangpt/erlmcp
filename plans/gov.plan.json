{
  "tier": "gov",
  "name": "Government Tier - FIPS-140-2, Audit Logging",
  "description": "Government-grade tier with FIPS-140-2 encryption, comprehensive audit logging, and compliance features",
  "pricing": {
    "model": "flat-per-deployment",
    "description": "No metering, no surprise overages",
    "cost": "Government license pricing"
  },
  "envelope": {
    "throughput": {
      "value": 1800,
      "unit": "msg_per_s",
      "definition": "JSON-RPC messages (requests + responses) with FIPS-140-2 encryption overhead",
      "note": "900 req/s × 2 (req + resp) = 1800 msg/s (includes 15% encryption overhead)",
      "workload_id": "tcp_sustained_50k_1kib_gov",
      "transport": "tcp",
      "scope": "per_node",
      "duration_s": 30,
      "encryption": "FIPS-140-2 (AES-256-GCM)",
      "encryption_overhead_pct": 15,
      "audit_overhead_pct": 8
    },
    "concurrent_connections": {
      "value": 50000,
      "unit": "connections",
      "workload_id": "tcp_sustained_50k_1kib_gov",
      "transport": "tcp",
      "scope": "per_node",
      "encryption": "FIPS-140-2"
    },
    "queue_depth": {
      "value": 300000,
      "unit": "messages",
      "scope": "per_node",
      "component": "erlmcp_server_mailbox"
    },
    "latency": {
      "p50_ms": 5,
      "p95_ms": 28,
      "p99_ms": 80,
      "workload_id": "tcp_sustained_50k_1kib_gov",
      "transport": "tcp",
      "measurement_point": "client_to_client",
      "encryption_overhead_ms": 3,
      "audit_overhead_ms": 2
    },
    "failover_sla": {
      "value": 1,
      "unit": "seconds",
      "topology": "3_node_cluster_fips",
      "detection_mechanism": "net_kernel_monitor",
      "workload_id": "ha_failover_test_fips"
    },
    "connection_timeout": {
      "value": 90,
      "unit": "seconds"
    }
  },
  "memory": {
    "per_connection_heap_mib": 0.052,
    "per_connection_state_mib": 0.015,
    "per_node_base_overhead_mib": 184,
    "per_node_total_rss_mib": 3584,
    "workload_id": "tcp_sustained_50k_1kib_gov",
    "connections": 50000,
    "scope": "per_node",
    "environment": "gov_fips_hardware",
    "formula": "base_overhead (184) + (50000 conn × 0.067 MiB) + overhead_margin (50) ≈ 3584 MiB",
    "fips_module_overhead_mib": 34,
    "audit_buffer_mib": 128,
    "ssl_fips_session_cache_mib": 96,
    "breakdown": {
      "beam_vm_base": 86,
      "kernel_stdlib": 32,
      "ssl_fips": 96,
      "audit_subsystem": 128,
      "fips_crypto_module": 34,
      "erlmcp_app": 28
    }
  },
  "limits": {
    "max_message_size_bytes": 5242880,
    "max_payload_size_mb": 50,
    "max_concurrent_requests_per_conn": 64,
    "memory_limit_mb": 2048,
    "cpu_time_limit_seconds": 450,
    "backpressure_threshold_bytes": 33554432
  },
  "features": {
    "client": true,
    "server": true,
    "stdio_transport": true,
    "tcp_transport": true,
    "http_transport": true,
    "websocket_transport": true,
    "sse_transport": true,
    "rate_limiting": true,
    "connection_pooling": true,
    "circuit_breaker": true,
    "otel_observability": "comprehensive",
    "audit_logging": true,
    "fips_140_2": true,
    "high_availability": true,
    "multi_region_support": false,
    "encrypted_transport": true,
    "tls_1_3_only": true,
    "key_rotation": true,
    "compliance_reporting": true
  },
  "refusal_behavior": {
    "throughput_exceeded": {
      "http_status": 429,
      "error_code": "rate_limit_exceeded",
      "message": "Request rate exceeds tier limit (1800 msg/s, 900 req/s)",
      "retry_after_seconds": 45,
      "audit_log": true
    },
    "queue_depth_exceeded": {
      "http_status": 503,
      "error_code": "service_unavailable",
      "message": "System overloaded, queue depth exceeded",
      "retry_after_seconds": 15,
      "audit_log": true
    },
    "connection_limit_exceeded": {
      "error_code": "connection_limit",
      "message": "Maximum 50,000 concurrent connections exceeded",
      "close_code": 1008,
      "audit_log": true
    },
    "message_size_exceeded": {
      "http_status": 413,
      "error_code": "payload_too_large",
      "message": "Message exceeds 5MB limit",
      "audit_log": true
    },
    "fips_compliance_violation": {
      "http_status": 403,
      "error_code": "fips_violation",
      "message": "Operation violates FIPS-140-2 compliance requirements",
      "audit_log": true
    },
    "encryption_failure": {
      "http_status": 500,
      "error_code": "encryption_error",
      "message": "Encryption failure - operation rejected",
      "audit_log": true
    }
  },
  "evidence": {
    "sbom": "plans/gov-sbom.json",
    "provenance": "plans/gov-provenance.json",
    "chaos_report": "docs/plans/gov-chaos-report.md",
    "benchmark_report": "docs/plans/gov-benchmark-report.md",
    "audit_schema": "plans/gov-audit-schema.json",
    "fips_certification": "plans/gov-fips-140-2-cert.txt",
    "compliance_report": "docs/plans/gov-compliance-report.md"
  },
  "compliance": {
    "mcp_version": "2025-11-25",
    "features_implemented": 52,
    "security_level": "maximum",
    "audit_trail": true,
    "fips_140_2": true,
    "encryption_standard": "AES-256-GCM",
    "key_derivation": "PBKDF2-SHA256",
    "sla_monitoring": true
  },
  "sla": {
    "availability_percentage": 99.99,
    "throughput_guarantee": {
      "value": 1800,
      "unit": "msg_per_s",
      "workload_id": "tcp_sustained_50k_1kib_gov",
      "scope": "per_node",
      "encryption": "FIPS-140-2"
    },
    "failover_time": {
      "value": 15,
      "unit": "seconds",
      "topology": "3_node_cluster_fips"
    },
    "recovery_sla": {
      "value": 10,
      "unit": "minutes"
    },
    "audit_retention": {
      "value": 2555,
      "unit": "days",
      "note": "7 years retention"
    }
  },
  "audit": {
    "log_all_operations": true,
    "log_authentication": true,
    "log_encryption_events": true,
    "log_access_violations": true,
    "log_system_events": true,
    "retention_policy": "7_years",
    "immutable_logs": true,
    "log_signing": true,
    "performance_impact": {
      "latency_overhead_ms": 2,
      "throughput_overhead_pct": 8,
      "memory_overhead_mib": 128
    }
  },
  "metrology_compliance": {
    "version": "v1.5.0",
    "validated": "2026-01-27",
    "validator": "scripts/validate_plan_metrology.sh",
    "violations": 0,
    "workload_definitions": "bench/workloads/",
    "environment_definitions": "bench/environments/",
    "metrics_glossary": "docs/metrology/METRICS_GLOSSARY.md",
    "fips_validated": true
  }
}
