---
# ============================================================================
# erlmcp Kubernetes Secrets Manifest
# ============================================================================
# WARNING: This is a TEMPLATE file with placeholder values.
# DO NOT commit actual secrets to version control!
#
# Production Deployment Instructions:
#
# Option 1: Using kubectl create secret (recommended)
# -------------------------------------------
# kubectl create secret generic erlmcp-secrets \
#   --from-literal=erlang-cookie=$(openssl rand -base64 32) \
#   --from-literal=jwt-secret=$(openssl rand -base64 32) \
#   --from-literal=api-key=$(openssl rand -hex 32) \
#   --from-literal=db-name=erlmcp \
#   --from-literal=db-user=erlmcp \
#   --from-literal=db-password=$(openssl rand -base64 24) \
#   --namespace=erlmcp \
#   --dry-run=client -o yaml | kubectl apply -f -
#
# Option 2: Using Sealed Secrets (for GitOps)
# -------------------------------------------
# kubectl create secret generic erlmcp-secrets \
#   --from-literal=erlang-cookie=$(openssl rand -base64 32) \
#   --from-literal=jwt-secret=$(openssl rand -base64 32) \
#   --from-literal=api-key=$(openssl rand -hex 32) \
#   --from-literal=db-name=erlmcp \
#   --from-literal=db-user=erlmcp \
#   --from-literal=db-password=$(openssl rand -base64 24) \
#   --namespace=erlmcp \
#   --dry-run=client -o yaml | \
#   kubeseal -f - -w k8s/secrets/erlmcp-sealed.yaml
#
# Option 3: Using External Secrets Operator
# -------------------------------------------
# Create ExternalSecret referencing your cloud provider's secret store
# ============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: erlmcp-secrets
  namespace: erlmcp
  labels:
    app: erlmcp
    component: secrets
    managed-by: ggen
  annotations:
    description: "Application secrets for erlmcp - DO NOT COMMIT"
    erlmcp.org/secret-class: application
type: Opaque
immutable: false
stringData:
  # Erlang Distribution Cookie
  # Required for Erlang node clustering and distribution
  # MUST be identical across all nodes in the cluster
  # Generate: openssl rand -base64 32
  erlang-cookie: "CHANGE_ME_IN_PRODUCTION_USE_OPENSSL_RAND_BASE64_32"

  # JWT Secret for Authentication
  # Used for signing JWT tokens for API authentication
  # Should be at least 32 bytes (256 bits) for HS256
  # Generate: openssl rand -base64 32
  jwt-secret: "CHANGE_ME_IN_PRODUCTION_USE_32_BYTES_OR_MORE"

  # External API Key
  # For external service integrations
  # Generate: openssl rand -hex 32
  api-key: "CHANGE_ME_EXTERNAL_SERVICE_API_KEY"

  # Database Connection Settings
  db-name: "erlmcp"
  db-user: "erlmcp"
  db-password: "CHANGE_ME_SECURE_DB_PASSWORD"

  # OAuth2 Configuration (leave empty if not using OAuth2)
  oauth2-client-id: ""
  oauth2-client-secret: ""

---
# ============================================================================
# TLS Certificate Secret
# ============================================================================
# For TLS termination at the pod level
#
# Generate self-signed certificate for testing:
# openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
#   -keyout tls.key -out tls.crt \
#   -subj "/CN=erlmcp.erlmcp.svc.cluster.local"
#
# Create with:
# kubectl create secret tls erlmcp-tls \
#   --cert=tls.crt --key=tls.key \
#   --namespace=erlmcp
# ============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: erlmcp-tls
  namespace: erlmcp
  labels:
    app: erlmcp
    component: tls
    managed-by: ggen
  annotations:
    description: "TLS certificate for HTTPS"
    erlmcp.org/secret-class: tls
type: kubernetes.io/tls
# data:
#   tls.crt: LS0tLS1CRUdJTi... (base64 encoded certificate)
#   tls.key: LS0tLS1CRUdJTi... (base64 encoded key)
#   ca.crt: LS0tLS1CRUdJTi... (optional CA certificate)

---
# ============================================================================
# Docker Registry Pull Secret
# ============================================================================
# For pulling images from private container registries
#
# Create with:
# kubectl create secret docker-registry erlmcp-pull-secret \
#   --docker-server=ghcr.io \
#   --docker-username=YOUR_USERNAME \
#   --docker-password=YOUR_TOKEN \
#   --namespace=erlmcp
# ============================================================================

# apiVersion: v1
# kind: Secret
# metadata:
#   name: erlmcp-pull-secret
#   namespace: erlmcp
#   labels:
#     app: erlmcp
#     component: registry
#     managed-by: ggen
#   annotations:
#     description: "Docker registry pull secret"
#     erlmcp.org/secret-class: registry
# type: kubernetes.io/dockerconfigjson
# data:
#   .dockerconfigjson: BASE64_ENCODED_DOCKER_CONFIG_JSON

---
# ============================================================================
# Basic Auth Secret (Optional)
# ============================================================================
# For basic authentication to external services
# ============================================================================

# apiVersion: v1
# kind: Secret
# metadata:
#   name: erlmcp-basic-auth
#   namespace: erlmcp
#   labels:
#     app: erlmcp
#     component: auth
#     managed-by: ggen
#   annotations:
#     description: "Basic auth credentials for external services"
#     erlmcp.org/secret-class: auth
# type: kubernetes.io/basic-auth
# data:
#   username: BASE64_ENCODED_USERNAME
#   password: BASE64_ENCODED_PASSWORD

---
# ============================================================================
# SSH Auth Secret (Optional)
# ============================================================================
# For SSH authentication to external services
# ============================================================================

# apiVersion: v1
# kind: Secret
# metadata:
#   name: erlmcp-ssh-auth
#   namespace: erlmcp
#   labels:
#     app: erlmcp
#     component: ssh
#     managed-by: ggen
#   annotations:
#     description: "SSH authentication credentials"
#     erlmcp.org/secret-class: ssh
# type: kubernetes.io/ssh-auth
# data:
#   ssh-privatekey: BASE64_ENCODED_PRIVATE_KEY
#   # ssh-publickey: BASE64_ENCODED_PUBLIC_KEY  # optional

---
# ============================================================================
# Service Account Token Secret (Optional)
# ============================================================================
# For service account token-based authentication
# ============================================================================

# apiVersion: v1
# kind: Secret
# metadata:
#   name: erlmcp-sa-token
#   namespace: erlmcp
#   labels:
#     app: erlmcp
#     component: service-account
#     managed-by: ggen
#   annotations:
#     description: "Service account token"
#     erlmcp.org/secret-class: service-account
# type: kubernetes.io/service-account-token
# data:
#   token: BASE64_ENCODED_TOKEN
