================================================================================
XREF CRITICAL ISSUES - QUICK FIX GUIDE
================================================================================

üö® CRITICAL: JWT Authentication BROKEN
=======================================
File: apps/erlmcp_core/src/erlmcp_auth.erl

Line 230: jose:jwk_from_pem(PemData)
  -> CHANGE TO: jose_jwk:from_pem(PemData)

Line 500: jose:jwk_from_pem(PemData)
  -> CHANGE TO: jose_jwk:from_pem(PemData)

Line 500: jose:jwt_verify(Token, Jwk)
  -> CHANGE TO: jose_jwt:verify(Jwk, Token)

‚ö†Ô∏è  HIGH PRIORITY: Missing Validation Modules
============================================
1. erlmcp_schema_validator - Implement or add to xref_ignores
2. erlmcp_prompt_argument_validator - Implement or add to xref_ignores
3. erlmcp_tls_validation - Implement or add to xref_ignores

üìã MEDIUM PRIORITY: Missing Functions
=====================================
1. erlmcp_registry:update_server/2 - Export or implement
2. erlmcp_refusal:is_valid_code/1 - Export function
3. tcps_quality_gates module - Implement or add to xref_ignores

üîß QUICK FIX COMMANDS
====================

1. Fix JWT auth (critical):
   cd apps/erlmcp_core/src
   sed -i.bak 's/jose:jwk_from_pem/jose_jwk:from_pem/g' erlmcp_auth.erl
   sed -i.bak 's/jose:jwt_verify/jose_jwt:verify/g' erlmcp_auth.erl
   # Note: Also need to swap argument order for jwt_verify

2. Add to xref_ignores in rebar.config:
   {erlmcp_schema_registry, handle_call, 3},
   {erlmcp_server, validate_prompt_arguments, 3},
   {erlmcp_transport_http_server, build_gun_opts, 1},
   {erlmcp_hooks, do_post_task, 3},
   {erlmcp_hooks, do_session_end, 2},
   {erts_debug, size_of, 1}

3. Verify fix:
   rebar3 xref

================================================================================
