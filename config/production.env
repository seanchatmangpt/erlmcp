# Production Environment Configuration
# GCP prod project with hardened security, high availability, and monitoring

# Application
APP_ENV=production
LOG_LEVEL=warn
RUST_LOG=warn

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_CONCURRENCY=16
REQUEST_TIMEOUT_MS=30000

# Database
DB_HOST=cloudsql-prod.c.taiea-prod.internal
DB_PORT=5432
DB_NAME=erlmcp_prod
DB_USER=erlmcp-sa
DB_PASSWORD=${PROD_DB_PASSWORD}
DB_SSL_MODE=require
DB_POOL_SIZE=25
DB_POOL_TIMEOUT=60
DB_MAX_LIFETIME_SECS=600
DB_IDLE_TIMEOUT_SECS=300

# Firestore (production database)
FIRESTORE_ENABLED=true
FIRESTORE_PROJECT_ID=taiea-prod
FIRESTORE_CREDENTIALS_PATH=/var/secrets/google/key.json
FIRESTORE_BACKUP_ENABLED=true
FIRESTORE_BACKUP_RETENTION_DAYS=30

# Redis (for caching and sessions)
REDIS_ENABLED=true
REDIS_HOST=redis-prod.c.taiea-prod.internal
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=${PROD_REDIS_PASSWORD}
REDIS_CLUSTER_ENABLED=true
REDIS_CLUSTER_NODES=3
REDIS_SENTINEL_ENABLED=true

# Observability
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=https://otel.taiea-prod.svc.cluster.local:4317
OTEL_EXPORTER_OTLP_CERTIFICATE=/var/secrets/otel/ca.crt
JAEGER_ENDPOINT=https://jaeger.taiea-prod.svc.cluster.local:14268/api/traces
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.01
DATADOG_ENABLED=true
DATADOG_API_KEY=${PROD_DATADOG_API_KEY}
PROMETHEUS_ENABLED=true
PROMETHEUS_LISTEN_ADDR=0.0.0.0:9090

# Security
JWT_SECRET_KEY=${PROD_JWT_SECRET}
JWT_ALGORITHM=RS256
JWT_PRIVATE_KEY_PATH=/var/secrets/keys/jwt-private.pem
JWT_PUBLIC_KEY_PATH=/var/secrets/keys/jwt-public.pem
SESSION_TIMEOUT_SECS=1800
ALLOW_INSECURE_HTTP=false
TLS_ENABLED=true
TLS_CERT_PATH=/var/secrets/tls/tls.crt
TLS_KEY_PATH=/var/secrets/tls/tls.key

# Feature Flags
FEATURE_RATE_LIMITING=true
FEATURE_RATE_LIMIT_PER_SECOND=1000
FEATURE_ASYNC_PROCESSING=true
FEATURE_WEBHOOK_DELIVERY=true
FEATURE_EXPERIMENTAL=false

# Debug Options
DEBUG_SQL_QUERIES=false
DEBUG_HEADERS=false
ENABLE_PROFILING=false
ENABLE_PPROF=false

# Service Discovery
SERVICE_MESH_ENABLED=true
CONSUL_ENABLED=false
ISTIO_ENABLED=true
ISTIO_NAMESPACE=taiea-prod

# Cache Settings
CACHE_TTL_SECS=3600
CACHE_MAX_SIZE=100000

# GCP Settings
GCP_PROJECT_ID=taiea-prod
GCP_REGION=us-central1
GCP_NETWORK=prod-vpc
GCP_KMS_KEY_RING=taiea-prod-keys
GCP_KMS_CRYPTO_KEY=taiea-prod-app-key

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL_SECS=10

# Alerting (strict thresholds)
ALERT_THRESHOLD_ERROR_RATE=0.001
ALERT_THRESHOLD_LATENCY_P99=500
ALERT_THRESHOLD_LATENCY_P999=1000
ALERT_THRESHOLD_MEMORY=0.75
ALERT_THRESHOLD_CPU=0.70
ALERT_THRESHOLD_GC_PAUSE=100

# Backup & Recovery
BACKUP_ENABLED=true
BACKUP_FREQUENCY=HOURLY
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=gs://taiea-prod-backups
BACKUP_ENCRYPTION_KEY=${PROD_BACKUP_ENCRYPTION_KEY}

# Disaster Recovery
DR_ENABLED=true
DR_FAILOVER_ENABLED=true
DR_REPLICA_REGION=us-east1
DR_REPLICA_PROJECT=taiea-prod-dr

# Compliance
COMPLIANCE_MODE=true
AUDIT_LOG_ENABLED=true
AUDIT_LOG_DESTINATION=gs://taiea-prod-audit-logs
AUDIT_LOG_RETENTION_DAYS=365
PII_DATA_MASKING=true

# Version Pinning
APP_VERSION=${APP_VERSION}
COMMIT_SHA=${COMMIT_SHA}
BUILD_TIMESTAMP=${BUILD_TIMESTAMP}
