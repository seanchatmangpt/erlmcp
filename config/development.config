%% Development configuration for erlmcp
%% This configuration enables more verbose logging and debugging features
[
    {erlmcp, [
        %% Server configuration
        {server_name, erlmcp_dev_server},
        {port, 8080},
        {max_connections, 50},  % Lower for development
        {timeout, 10000},       % Higher timeout for debugging
        {acceptors, 5},         % Fewer acceptors for development
        
        %% Socket options
        {socket_opts, [
            {reuseaddr, true},
            {keepalive, true},
            {nodelay, true}
        ]},
        
        %% Protocol options
        {protocol_opts, [
            {timeout, 10000},
            {max_message_size, 1048576}  % 1MB
        ]},
        
        %% Transport configurations
        {transports, [
            %% Standard I/O transport (enabled for development)
            {stdio, #{
                enabled => true,
                buffer_size => 512,     % Smaller buffer for quicker debugging
                timeout => 10000,       % Higher timeout for debugging
                encoding => utf8
            }},
            
            %% TCP transport (enabled for development testing)
            {tcp, #{
                enabled => true,
                port => 8080,
                acceptors => 5,
                socket_opts => [
                    {reuseaddr, true},
                    {keepalive, true},
                    {nodelay, true}
                ],
                backlog => 512
            }},
            
            %% HTTP transport (enabled for development testing)
            {http, #{
                enabled => true,
                port => 8081,
                path => "/mcp",
                ssl_opts => [],
                cors_enabled => true
            }}
        ]},
        
        %% Logging configuration (verbose for development)
        {log_level, debug},
        {log_file, "log/erlmcp-dev.log"},
        
        %% Monitoring and metrics (enabled for development)
        {metrics_enabled, true},
        {tracing_enabled, true}
    ]},
    
    %% Kernel configuration
    {kernel, [
        {logger_level, debug},
        {logger, [
            {handler, default, logger_std_h, #{
                level => debug,
                config => #{
                    type => standard_io,
                    sync_mode_qlen => 10,
                    drop_mode_qlen => 1000,
                    flush_qlen => 2000
                },
                formatter => {logger_formatter, #{
                    single_line => false,
                    template => [time, " [", level, "] ", pid, " ", mfa, ":", line, " - ", msg, "\n"]
                }}
            }},
            {handler, file, logger_std_h, #{
                level => debug,
                config => #{
                    type => {file, "log/erlmcp-dev.log"},
                    sync_mode_qlen => 10,
                    drop_mode_qlen => 1000,
                    flush_qlen => 2000
                },
                formatter => {logger_formatter, #{
                    single_line => false,
                    template => [time, " [", level, "] ", pid, " ", mfa, ":", line, " - ", msg, "\n"]
                }}
            }}
        ]}
    ]},
    
    %% SASL configuration (verbose for development)
    {sasl, [
        {sasl_error_logger, {file, "log/sasl-error-dev.log"}},
        {errlog_type, all},
        {error_logger_mf_dir, "log/sasl-dev"},
        {error_logger_mf_maxbytes, 5242880},   % 5MB (smaller for development)
        {error_logger_mf_maxfiles, 3}
    ]}
].