# Staging Environment Configuration
# GCP dev project with test Firestore and integration testing capabilities

# Application
APP_ENV=staging
LOG_LEVEL=info
RUST_LOG=info

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_CONCURRENCY=8
REQUEST_TIMEOUT_MS=30000

# Database
DB_HOST=cloudsql-staging.c.taiea-dev.internal
DB_PORT=5432
DB_NAME=erlmcp_staging
DB_USER=erlmcp-sa
DB_PASSWORD=${STAGING_DB_PASSWORD}
DB_SSL_MODE=require
DB_POOL_SIZE=15
DB_POOL_TIMEOUT=30

# Firestore (test database on dev project)
FIRESTORE_ENABLED=true
FIRESTORE_PROJECT_ID=taiea-dev
FIRESTORE_CREDENTIALS_PATH=/var/secrets/google/key.json
FIRESTORE_EMULATOR_HOST=

# Redis (for caching in staging)
REDIS_ENABLED=true
REDIS_HOST=redis-staging.c.taiea-dev.internal
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=${STAGING_REDIS_PASSWORD}

# Observability
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://collector-staging.taiea-dev.svc.cluster.local:4317
JAEGER_ENDPOINT=http://jaeger-staging.taiea-dev.svc.cluster.local:14268/api/traces
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.1

# Security
JWT_SECRET_KEY=${STAGING_JWT_SECRET}
SESSION_TIMEOUT_SECS=7200
ALLOW_INSECURE_HTTP=false

# Feature Flags
FEATURE_RATE_LIMITING=true
FEATURE_ASYNC_PROCESSING=true
FEATURE_WEBHOOK_DELIVERY=true
FEATURE_EXPERIMENTAL=true

# Debug Options
DEBUG_SQL_QUERIES=false
DEBUG_HEADERS=false
ENABLE_PROFILING=true
ENABLE_PPROF=false

# Service Discovery
SERVICE_MESH_ENABLED=true
CONSUL_ENABLED=false
ISTIO_ENABLED=true
ISTIO_NAMESPACE=taiea-staging

# Cache Settings
CACHE_TTL_SECS=1800
CACHE_MAX_SIZE=10000

# GCP Settings
GCP_PROJECT_ID=taiea-dev
GCP_REGION=us-central1
GCP_NETWORK=staging-vpc

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL_SECS=30

# Alerting (less aggressive than prod)
ALERT_THRESHOLD_ERROR_RATE=0.05
ALERT_THRESHOLD_LATENCY_P99=2000
ALERT_THRESHOLD_MEMORY=0.85
