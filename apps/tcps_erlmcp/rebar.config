%% ============================================================================
%% tcps_erlmcp - Toyota Code Production System
%% ============================================================================
%% SHACL validation, receipt chains, quality gates, Kanban, Jidoka
%% ============================================================================

{erl_opts, [
    debug_info,
    {i, "include"},
    {i, "../../include"},
    nowarn_export_vars
]}.

{deps, [
    {bbmustache, "1.12.2"},
    {cowboy, "2.10.0"},
    {jobs, "0.10.0"},
    {fs, "0.9.2"},
    {erlmcp_core, {path, "../erlmcp_core"}},
    {erlmcp_observability, {path, "../erlmcp_observability"}}
]}.

{eunit_opts, [verbose]}.

{dialyzer, [
    {warnings, [
        unmatched_returns,
        error_handling
    ]}
]}.

{xref_checks, [
    undefined_function_calls,
    undefined_functions
]}.

{xref_ignores, [
    %% Cowboy/Jobs external APIs
    {cowboy, start_clear, 3},
    {jobs, add_queue, 2}
]}.

{cover_enabled, true}.
{cover_export_enabled, true}.

{profiles, [
    {test, [
        {deps, [
            {jsx, "3.1.0"}
        ]},
        {erl_opts, [
            debug_info,
            {i, "include"},
            {i, "../../include"},
            nowarn_export_vars
        ]}
    ]}
]}.

{ct_opts, [
    {dir, "test"},
    {logdir, "_build/test/logs"},
    {keep_logs, 5}
]}.
