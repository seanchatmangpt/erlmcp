%% erlmcp Compliance Framework Configuration
%% This configuration file contains all compliance framework settings
%% Customize these settings based on your organization's requirements

{compliance_config, [
    %% =============================================================================
    %% FRAMEWORK CONFIGURATION
    %% =============================================================================

    %% Enable/disable specific compliance frameworks
    {frameworks, [
        {soc2, true},      % SOC2 Type I & II compliance
        {hipaa, true},     % HIPAA healthcare compliance
        {gdpr, true},      % GDPR data protection
        {iso27001, true}   % ISO27001 information security
    ]},

    %% Framework-specific configurations
    {framework_settings, [
        %% SOC2 Configuration
        {soc2, [
            {control_catalog, 93},           % Total number of controls
            {audit_frequency, quarterly},     % Audit frequency
            {retention_period, 2555},        % 7 years in days
            {evidence_required, true},       % Evidence collection
            {approval_workflow, true},        % Approval workflow
            {self_assessment, true},          % Self-assessment capability
            {control_categories, [
                "Security Controls",       % CC6
                "Availability Controls",   % CC1
                "Processing Integrity",    % CC7
                "Confidentiality Controls",% CC2
                "Privacy Controls"        % CC14
            ]}
        ]},

        %% HIPAA Configuration
        {hipaa, [
            {control_catalog, 60},           % Total number of safeguards
            {audit_frequency, semi_annual},  % Audit frequency
            {retention_period, 1825},        % 5 years in days
            {phi_protection, true},          % PHI data protection
            {breach_notification, true},     % Breach notification
            {training_requirements, true},   % Staff training
            {business_associate_agreements, true},
            {safeguards, [
                "Administrative",          % 164.306
                "Physical",               % 164.310
                "Technical",              % 164.312
                "Breach Notification",    % 164.400
                "Privacy Rules"          % 164.530
            ]}
        ]},

        %% GDPR Configuration
        {gdpr, [
            {control_catalog, 99},           % Total requirements
            {audit_frequency, annual},       % Audit frequency
            {retention_period, 730},         % 2 years for processing records
            {data_subject_rights, true},      % Data subject rights
            {consent_management, true},       % Consent management
            {dpo_integration, true},         % DPO integration
            {privacy_by_design, true},       % Privacy by design
            {data_breach_response, true},    % Data breach response
            {data_transfer_mechanisms, [
                "Standard Contractual Clauses",
                "Binding Corporate Rules",
                "Adequacy Decisions"
            ]}
        ]},

        %% ISO27001 Configuration
        {iso27001, [
            {control_catalog, 114},          % Total number of controls
            {audit_frequency, annual},       % Audit frequency
            {retention_period, 2555},        % 7 years
            {isms_implementation, true},     % ISMS implementation
            {risk_assessment, true},         % Risk assessment process
            {internal_auditing, true},       % Internal auditing
            {management_review, true},       % Management review
            continual_improvement, true,     % Continual improvement
            {control_families, [
                "Information Security Policies",     % A.5
                "Organization of Information Security",% A.6
                "Human Resource Security",           % A.7
                "Asset Management",                  % A.8
                "Access Control",                   % A.9
                "Cryptography",                     % A.10
                "Physical and Environmental Security",% A.11
                "Operations Security",               % A.12
                "Communications Security",           % A.13
                "System Acquisition",                % A.14
                "Supplier Relationships",            % A.15
                "Incident Management",              % A.16
                "Business Continuity",               % A.17
                "Compliance"                        % A.18
            ]}
        ]}
    ]},

    %% =============================================================================
    %% AUDIT LOGGING CONFIGURATION
    %% =============================================================================

    %% Audit logging settings
    {audit_logging, [
        {retention_days, 2555},               % 7 years retention
        {max_events, 1000000},                % Maximum events in memory
        {batch_size, 1000},                   % Batch processing size
        {compression_enabled, true},          % Event compression
        {digital_signatures, true},            % Digital signatures for integrity
        {encryption_at_rest, true},           % Encryption for stored logs
        {encryption_in_transit, true},        % TLS for transit
        {log_levels, [debug, info, warning, error, critical]},
        {event_types, [
            "policy_change",
            "control_change",
            "access_event",
            "data_access",
            "data_transfer",
            "incident",
            "remediation",
            "audit",
            "testing",
            "approval"
        ]},
        {event_severities, [low, medium, high, critical]},
        {auditor_roles, ["compliance_officer", "auditor", "security_officer"]}
    ]},

    %% =============================================================================
    %% MONITORING CONFIGURATION
    %% =============================================================================

    %% Real-time monitoring settings
    {monitoring, [
        {check_interval, 300000},             % 5 minutes between checks
        {alert_threshold, 3},                % Severity threshold for alerts
        {max_concurrent_checks, 100},          % Maximum concurrent checks
        {violation_window, 3600000},          % 1 hour window for violation detection
        {escalation_policy, [
            {1, ["security_team"]},           % Low severity
            {2, ["security_team", "compliance_officer"]}, % Medium
            {3, ["security_team", "compliance_officer", "cto"]}, % High
            {4, ["security_team", "compliance_officer", "cto", "ceo"]}, % Critical
            {5, ["security_team", "compliance_officer", "cto", "ceo", "board"]} % Emergency
        ]},
        {notifications, [
            {email, true},
            {sms, true},
            {slack, true},
            {webhook, true},
            {dashboard, true}
        ]},
        {continuous_monitoring, true},
        {health_check_interval, 30000},      % 30 seconds
        {performance_metrics, true}
    ]},

    %% =============================================================================
    %% POLICY MANAGEMENT CONFIGURATION
    %% =============================================================================

    %% Policy management settings
    {policy_management, [
        {versioning_enabled, true},           % Policy versioning
        {approval_required, true},            % Approval workflow
        {approval_workflow, [
            {"draft", "manager"},
            {"review", "compliance_officer"},
            {"approval", "executive"},
            {"published", "system"}
        ]},
        {policy_review_interval, 90},        % 90 days between reviews
        {policy_retention, 1825},            % 5 years retention
        {control_templates, [
            {soc2, "templates/soc2_control.json"},
            {hipaa, "templates/hipaa_safeguard.json"},
            {gdpr, "templates/gdpr_requirement.json"},
            {iso27001, "templates/iso27001_control.json"}
        ]},
        {custom_policies, []}                 % List of custom policy paths
    ]},

    %% =============================================================================
    %% REPORTING CONFIGURATION
    %% =============================================================================

    %% Reporting settings
    {reporting, [
        {report_formats, ["pdf", "html", "json", "csv"]},
        {template_directories, [
            "templates/reports",
            "templates/audit_packs",
            "templates/evidence"
        ]},
        {auto_schedule, true},                % Auto-generate scheduled reports
        {scheduled_reports, [
            {daily, "compliance_summary"},
            {weekly, "violation_report"},
            {monthly, "audit_pack"},
            {quarterly, "framework_assessment"}
        ]},
        {export_formats, [
            {pdf, "application/pdf"},
            {json, "application/json"},
            {csv, "text/csv"},
            {html, "text/html"}
        ]},
        {report_retention, 730},              % 2 years
        {evidence_packaging, true},
        {custom_reports, []}
    ]},

    %% =============================================================================
    %% ENFORCEMENT CONFIGURATION
    %% =============================================================================

    %% Policy enforcement settings
    {enforcement, [
        {real_time_enforcement, true},       % Real-time enforcement
        {enforcement_mode, active},          % active, passive, audit_only
        {decision_timeout, 5000},            % 5 seconds timeout
        {max_concurrent_enforcements, 500},  % Maximum concurrent enforcement
        {access_control, [
            {authentication_required, true},
            {authorization_required, true},
            {mfa_enabled, true},
            {session_timeout, 3600},           % 1 hour
            {ip_whitelisting, false},
            {device_trust, true}
        ]},
        {data_handling, [
            {encryption_required, true},
            {data_classification_levels, ["public", "internal", "sensitive", "confidential"]},
            {data_handling_policies, [
                {"public", "any"},
                {"internal", "authorized_users"},
                {"sensitive", "need_to_know"},
                {"confidential", "strict_controls"}
            ]}
        ]},
        {retention_policies, [
            {"financial_records", 2555},      % 7 years
            {"personal_data", 730},           % 2 years
            {"audit_logs", 2555},             % 7 years
            {"system_logs", 1095}             % 3 years
        ]}
    ]},

    %% =============================================================================
    %% ANALYTICS CONFIGURATION
    %% =============================================================================

    %% Analytics and reporting settings
    {analytics, [
        {trend_analysis, true},               % Compliance trend analysis
        {risk_prediction, true},              % Risk prediction
        {gap_analysis, true},                 % Gap analysis
        {benchmarking, true},                 % Industry benchmarking
        {forecasting, true},                  % Compliance forecasting
        {confidence_threshold, 0.8},          % 80% confidence for predictions
        {forecast_horizon, 365},              % 1 year forecast
        {risk_models, [
            "control_failure_risk",
            "audit_findings_risk",
            "industry_change_risk",
            "technology_obsolescence_risk"
        ]},
        {industry_benchmarks, [
            {"healthcare", 0.75},             % 75% average
            {"finance", 0.80},                % 80% average
            {"technology", 0.78}              % 78% average
        ]}
    ]},

    %% =============================================================================
    %% SECURITY CONFIGURATION
    %% =============================================================================

    %% Security settings
    {security, [
        {encryption_algorithm, "AES-256-GCM"}, % Encryption algorithm
        {key_rotation_days, 90},              % 90 days key rotation
        {signing_algorithm, "RSA-4096"},      % Digital signature algorithm
        {certificate_authority, "internal"},  % CA type
        {access_control, [
            {role_based_access, true},
            {least_privilege, true},
            {separation_of_duties, true},
            {access_review_interval, 90}      % 90 days
        ]},
        {authentication, [
            {mfa_required, true},
            {password_policy, [
                {min_length, 12},
                {require_uppercase, true},
                {require_lowercase, true},
                {require_numbers, true},
                {require_special_chars, true},
                {max_age_days, 90}
            ]}
        ]}
    ]},

    %% =============================================================================
    ** PERFORMANCE CONFIGURATION
    %% =============================================================================

    %% Performance tuning settings
    {performance, [
        {cache_size, 1000},                  % Cache size for policies
        {cache_ttl, 300},                    % 5 minutes cache TTL
        {max_concurrent_reports, 10},         % Maximum concurrent reports
        {audit_batch_size, 1000},             % Batch size for audit logs
        {metrics_collection_interval, 60000},% 1 minute metrics collection
        {connection_pool_size, 50},          % Database connection pool
        {queue_size, 10000},                 % Event queue size
        {compression_threshold, 1024},       % Compress events > 1KB
        {memory_monitoring, true},
        {cpu_monitoring, true}
    ]},

    %% =============================================================================
    ** INTEGRATION CONFIGURATION
    %% =============================================================================

    %% External integration settings
    {integration, [
        {mcp_resource_integration, true},      % MCP resource integration
        {observability_integration, true},    % OTEL integration
        {third_party_systems, [
            {"vault", true},                  % HashiCorp Vault
            {"pagerduty", true},              % PagerDuty alerts
            {"slack", true},                  % Slack notifications
            {"jira", true}                    % Jira ticketing
        ]},
        {api_endpoints, [
            {"audit_export", "/api/audit/export"},
            {"policy_management", "/api/policies"},
            {"compliance_dashboard", "/api/dashboard"},
            {"risk_assessment", "/api/risk"}
        ]},
        {webhook_configurations, [
            {alerts, "https://webhooks.example.com/alerts"},
            {reports, "https://webhooks.example.com/reports"},
            {events, "https://webhooks.example.com/events"}
        ]}
    ]},

    %% =============================================================================
    ** COMPLIANCE CERTIFICATION CONFIGURATION
    %% =============================================================================

    %% Compliance certification settings
    {certification, [
        {soc2_type_i, true},                  % SOC2 Type I certification
        {soc2_type_ii, true},                 % SOC2 Type II certification
        {hipaa_compliance, true},             % HIPAA compliance
        {gdpr_compliance, true},              % GDPR compliance
        {iso27001_certification, true},      % ISO27001 certification
        {audit_prep_mode, false},             % Audit preparation mode
        {compliance_packages, [
            {"soc2", "packages/soc2"},
            {"hipaa", "packages/hipaa"},
            {"gdpr", "packages/gdpr"},
            {"iso27001", "packages/iso27001"}
        ]},
        {evidence_templates, [
            {"configuration", "templates/evidence/configuration"},
            {"audit", "templates/evidence/audit"},
            {"testing", "templates/evidence/testing"},
            {"policy", "templates/evidence/policy"}
        ]}
    ]},

    %% =============================================================================
    ** DEVELOPER CONFIGURATION
    %% =============================================================================

    %% Development and testing settings
    {development, [
        {test_mode, false},                  % Enable test mode
        {mock_services, false},              % Mock external services
        {debug_level, info},                 % Debug logging level
        {performance_profiling, false},       % Enable performance profiling
        {test_frameworks, [eunit, common_test]},
        {coverage_threshold, 80},             % 80% test coverage required
        {linting_enabled, true},
        {formatting_enabled, true}
    ]},

    %% =============================================================================
    ** EMERGENCY CONFIGURATION
    %% =============================================================================

    %% Emergency override settings
    {emergency, [
        {emergency_mode, false},             % Emergency mode toggle
        {emergency_contacts, [
            "security_team@example.com",
            "compliance_officer@example.com",
            "cto@example.com"
        ]},
        {emergency_procedures, [
            "incident_response_plan.pdf",
            "breach_notification_protocol.pdf",
            "crisis_management_plan.pdf"
        ]},
        {override_permissions, [           % Users with emergency override
            "security_director",
            "compliance_director",
            "cto"
        ]}
    ]},

    %% =============================================================================
    ** CUSTOM CONFIGURATION
    %% =============================================================================

    %% Custom configuration for organization-specific requirements
    {custom, [
        {industry_specific_controls, []},    % Industry-specific controls
        {custom_compliance_requirements, []}, % Custom compliance requirements
        {organizational_policies, []},       % Organizational policies
        {regulatory_requirements, []},       % Additional regulatory requirements
        {stakeholder_requirements, []},       % Stakeholder-specific requirements
        {business_continuity_controls, []},   % BCP-related controls
        {disaster_recovery_controls, []}     % DR-related controls
    ]}
]}.