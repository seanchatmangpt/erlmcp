# Production environment values for erlmcp-enterprise
# Usage: helm install erlmcp-prod ./helm/erlmcp-enterprise -f helm/erlmcp-enterprise/values-production.yaml

global:
  cluster:
    name: "erlmcp-production"
    environment: "production"
    region: "us-east-1"

deployment:
  replicas: 3

statefulset:
  enabled: true
  replicas: 3

resources:
  requests:
    cpu: "1000m"
    memory: "2Gi"
  limits:
    cpu: "4000m"
    memory: "8Gi"

autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 100
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

podDisruptionBudget:
  enabled: true
  minAvailable: 2

ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-buffer-size: "16k"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: "erlmcp.example.com"
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: erlmcp-prod-tls
      hosts:
        - erlmcp.example.com

service:
  type: "LoadBalancer"
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
    service.beta.kubernetes.io/aws-load-balancer-cross-zone: "true"

app:
  erlang:
    env:
      ERLMCP_LOG_LEVEL: "warning"
      ERLMCP_METRICS_ENABLED: "true"

  sessions:
    enabled: true
    backend: "mnesia"
    sharding:
      enabled: true
      count: 16
      strategy: "consistent_hash"
    replication:
      enabled: true
      nodes: 3

  cache:
    enabled: true
    type: "redis"

  database:
    enabled: true
    type: "postgresql"

  queue:
    enabled: true
    type: "rabbitmq"

monitoring:
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: "15s"
    prometheusRule:
      enabled: true
  grafana:
    enabled: true

logging:
  level: "warning"
  format: "json"
  retention: 30

security:
  networkPolicy:
    enabled: true
  rbac:
    createClusterRoleBinding: false

storage:
  persistentVolumeClaim:
    enabled: true
    size: "100Gi"
    storageClass: "gp3"
  logs:
    enabled: true
    size: "20Gi"
    storageClass: "gp3"

backup:
  enabled: true
  schedule: "0 2 * * *"
  retention: "30d"

# ==============================================================================
# Production ResourceQuota Overrides
# ==============================================================================
resourceQuota:
  enabled: true

  types:
    compute:
      enabled: true
      hard:
        requests.cpu: "64"
        requests.memory: 128Gi
        limits.cpu: "128"
        limits.memory: 256Gi

    storage:
      enabled: true
      hard:
        persistentvolumeclaims: "30"
        requests.storage: "1Ti"

    objects:
      enabled: true
      hard:
        pods: "200"
        services: "50"
        services.loadbalancers: "3"
        services.nodeports: "10"
        secrets: "50"
        configmaps: "30"

    long-running:
      enabled: true
      hard:
        pods: "100"
        requests.cpu: "48"
        requests.memory: 96Gi
        limits.cpu: "96"
        limits.memory: 192Gi

    batch:
      enabled: true
      hard:
        pods: "30"
        requests.cpu: "8"
        requests.memory: 16Gi
        limits.cpu: "16"
        limits.memory: 32Gi

limitRange:
  enabled: true
  container:
    default:
      cpu: "2000m"
      memory: "4Gi"
    defaultRequest:
      cpu: "500m"
      memory: "1Gi"
    max:
      cpu: "16000m"
      memory: "32Gi"
    min:
      cpu: "100m"
      memory: "256Mi"

  persistentVolumeClaim:
    default:
      storage: "20Gi"
    max:
      storage: "1Ti"
    min:
      storage: "5Gi"

  pod:
    max:
      cpu: "32000m"
      memory: "64Gi"
