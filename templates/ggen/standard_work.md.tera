{#
  TCPS Standard Work Documentation Template

  Generates standard work procedures for production stages.

  Context Variables (required):
    - stage_name: string
    - stage_id: string
    - description: string
    - inputs: array of {name, type, source}
    - outputs: array of {name, type, destination}
    - steps: array of {step_name, action}
    - slo_time_budget_ms: integer
    - slo_success_rate: float
#}
# Standard Work: {{ stage_name }}

**Stage ID**: {{ stage_id }}
**Version**: 1.0.0
**Last Updated**: {{ updated_at | default(value=timestamp) }}
**Owner**: {{ owner | default(value="TCPS Team") }}

## Purpose

{{ description }}

## Service Level Objectives (SLOs)

- **Time Budget**: {{ slo_time_budget_ms }}ms ({{ slo_time_budget_ms | divided_by: 1000 }}s)
- **Success Rate**: {{ slo_success_rate | times: 100 }}%

## Inputs

| Name | Type | Source |
|------|------|--------|
{% for input in inputs -%}
| {{ input.name }} | {{ input.type }} | {{ input.source }} |
{% endfor %}

## Outputs

| Name | Type | Destination |
|------|------|-------------|
{% for output in outputs -%}
| {{ output.name }} | {{ output.type }} | {{ output.destination }} |
{% endfor %}

## Standard Procedure

{% for step in steps -%}
### Step {{ loop.index }}: {{ step.step_name }}

```bash
{{ step.action }}
```

{% if step.expected_result -%}
**Expected Result**: {{ step.expected_result }}
{% endif %}

{% if step.failure_mode -%}
**Failure Mode**: {{ step.failure_mode }}
**Recovery**: {{ step.recovery_action | default(value="Trigger Andon event") }}
{% endif %}

{% endfor %}

## Quality Gates

{% if quality_gates %}
{% for gate in quality_gates -%}
- **{{ gate.name }}**: {{ gate.criteria }}
  - Threshold: {{ gate.threshold }}
  - Action on Failure: {{ gate.failure_action }}
{% endfor %}
{% else %}
- All outputs must be valid
- Must complete within SLO time budget
- Must meet or exceed SLO success rate
{% endif %}

## Tools & Dependencies

{% if tools %}
{% for tool in tools -%}
- {{ tool.name }} ({{ tool.version }})
{% endfor %}
{% else %}
- Erlang/OTP 25+
- rebar3
{% endif %}

## Known Failure Modes

{% if failure_modes %}
| Failure Mode | Probability | Impact | Mitigation |
|--------------|-------------|--------|------------|
{% for fm in failure_modes -%}
| {{ fm.description }} | {{ fm.probability }} | {{ fm.impact }} | {{ fm.mitigation }} |
{% endfor %}
{% else %}
No documented failure modes yet. Update as issues are discovered.
{% endif %}

## Receipts Generated

{% if receipts %}
{% for receipt in receipts -%}
- {{ receipt.type }}: {{ receipt.description }}
{% endfor %}
{% else %}
- Production receipt with stage completion evidence
- SHACL validation report (if applicable)
{% endif %}

## Dependencies

{% if dependencies %}
{% for dep in dependencies -%}
- {{ dep }}
{% endfor %}
{% else %}
No dependencies on other stages.
{% endif %}

---

*This standard work document is generated from TCPS ontology*
*Generated by ggen v{{ generator_version | default(value="6.0.0") }}*
