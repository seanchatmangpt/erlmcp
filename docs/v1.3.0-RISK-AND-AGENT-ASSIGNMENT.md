# erlmcp v1.3.0 Risk Register & Agent Assignment Guide

**Date**: January 27, 2026
**Status**: SPECIFICATION PHASE
**Audience**: Project Managers, Risk Officers, Agent Coordinators

---

## EXECUTIVE RISK SUMMARY

| Risk Level | Count | Total Impact | Mitigation Status |
|-----------|-------|-------------|-------------------|
| CRITICAL | 1 | HIGH | Mitigated with fallbacks |
| HIGH | 3 | MEDIUM | Mitigated with testing strategy |
| MEDIUM | 8 | LOW-MEDIUM | Mitigated with contingencies |
| LOW | 6 | LOW | Acknowledged |

**Overall Risk**: MEDIUM (manageable with documented contingencies)

**Go/No-Go Decision**: GREEN - Proceed with enhanced monitoring

---

## DETAILED RISK REGISTER

### CRITICAL RISKS

#### CR-1: GC Pause Breaks Throughput Target
**Workstream**: Agent 1 (Transport Ceiling)
**Risk Level**: CRITICAL
**Probability**: MEDIUM (30%)
**Impact**: HIGH (misses 95K target)
**Trigger Events**:
- Large GC pause (>50ms) during benchmark
- Erlang heap fragmentation at scale
- Memory pressure in container

**Mitigation Strategy**:
1. **Pre-Testing** (DO THIS BEFORE Agent 1 runs):
   - Profile v0.6.0 with GC tracing enabled
   - Measure GC pause under current 42.6K msg/sec baseline
   - Identify if pauses are issue

2. **During Agent 1 Benchmark**:
   - Use GC tuning from v1.2.0 docs
   - Add `+zdbbl 32768` (larger binaries for less GC)
   - Add `+sbt db` (scheduler busy wait)
   - Measure p95 GC pause time

3. **Fallback Options**:
   - Reduce target to 80K msg/sec (still 1.8x baseline)
   - Implement per-message batching (less GC pressure)
   - Use larger payload size (8KB instead of 4KB)

4. **Acceptance Criteria**:
   - IF throughput ≥95K AND GC pause <50ms: PASS
   - IF throughput 80-95K AND GC pause <50ms: PASS (acceptable)
   - IF throughput <80K: FAIL (must investigate)

**Owner**: Agent 1 (performance-benchmarker)
**Timeline**: Day 1, 8 AM (before other agents start)
**Evidence Required**: GC trace with pause histogram, CPU profile

---

### HIGH RISKS

#### HR-1: 100K Registry Contention Creates Bottleneck
**Workstream**: Agent 5 (Registry Scaling)
**Risk Level**: HIGH
**Probability**: MEDIUM (40%)
**Impact**: HIGH (misses scaling target)
**Trigger Events**:
- ETS lock time >1ms at 100K
- GC pause spike under registry load
- Query latency drops below p99 target

**Mitigation Strategy**:
1. **Pre-Testing**:
   - Benchmark current `erlmcp_registry_sharded.erl` at 50K
   - Measure ETS lock statistics
   - Profile CPU hotspots

2. **During Agent 5 Benchmark**:
   - Ramp up gradually: 1K → 10K → 50K → 100K
   - Measure p99 at each level
   - Plot scaling curve (should be linear or sub-linear)

3. **Fallback Options**:
   - If p99 >1ms at 100K: Increase shard count to 32
   - If p99 still >1ms: Implement L1 cache (bloom filter or write-through)
   - Worst case: Reduce "100K target" to "50K per-node" (horizontal scaling)

4. **Acceptance Criteria**:
   - At 100K: p99 <1ms (target), p99 <2ms (acceptable), p99 >5ms (FAIL)

**Owner**: Agent 5 (code-analyzer)
**Timeline**: Day 2, 8 AM (after Agents 2-4 complete)
**Evidence Required**: Latency vs connection count graph, ETS lock statistics

---

#### HR-2: Circuit Breaker Recovery Too Slow
**Workstream**: Agent 3 (Circuit Breaker)
**Risk Level**: HIGH
**Probability**: LOW (20%)
**Impact**: HIGH (user experience suffers during outages)
**Trigger Events**:
- Remote service fails
- Recovery takes >5 minutes
- HALF_OPEN state stays stuck

**Mitigation Strategy**:
1. **During Agent 3 Implementation**:
   - Use standard SRE pattern (proven recovery time)
   - Test HALF_OPEN with N successful requests (not just 1)
   - Add exponential backoff randomization (jitter)

2. **Testing**:
   - Simulate service failure at time T=0
   - Measure time to full recovery
   - Test jitter prevents thundering herd

3. **Fallback Options**:
   - Reduce OPEN→HALF_OPEN timeout to 30s (more aggressive)
   - Increase HALF_OPEN success threshold to 5 (more conservative)
   - Add "manual recovery" API for operators

4. **Acceptance Criteria**:
   - Recovery starts: <60s (target), <120s (acceptable)
   - Full recovery: <5s after service is healthy again

**Owner**: Agent 3 (system-architect)
**Timeline**: Day 1 PM (after Agent 2 completes)
**Evidence Required**: Recovery time histogram, state transition trace

---

#### HR-3: Backpressure Backoff Causes Latency Spike
**Workstream**: Agent 2 (Bounded Backpressure)
**Risk Level**: HIGH
**Probability**: MEDIUM (35%)
**Impact**: MEDIUM (users see tail latency increase)
**Trigger Events**:
- Slow client causing queue backlog
- Backoff exponential increase triggers
- Latency p99 jumps from 1ms to 100ms+

**Mitigation Strategy**:
1. **During Agent 2 Design**:
   - Use jittered exponential backoff (not deterministic)
   - Cap max backoff at 100ms (not unbounded)
   - Add "fast path" for empty queue (no backoff)

2. **Testing**:
   - Send X msg/sec, receive Y msg/sec (X > Y to trigger backpressure)
   - Measure latency distribution with backpressure active
   - Plot p50, p95, p99 over time

3. **Fallback Options**:
   - Reduce cap backoff from 100ms to 50ms
   - Use fixed backoff instead of exponential
   - Implement priority queue (critical messages bypass queue)

4. **Acceptance Criteria**:
   - Without backpressure: p99 <2ms
   - With backpressure: p99 <50ms (acceptable spike)
   - With backpressure: p99 <100ms (pass but flag for follow-up)

**Owner**: Agent 2 (backend-dev)
**Timeline**: Day 1 PM (after Agent 1 baseline)
**Evidence Required**: Latency distribution histogram, backoff timing trace

---

### MEDIUM RISKS

#### MR-1: Bulkhead Restart Storm (Crash Loop)
**Workstream**: Agent 4 (Bulkheads)
**Risk Level**: MEDIUM
**Probability**: LOW (15%)
**Impact**: MEDIUM (system instability)
**Trigger Events**:
- Code bug in connection handler
- Bulkhead restarts too frequently
- Restart limit exceeded

**Mitigation Strategy**:
1. **Configuration**:
   - Set restart intensity: 5 restarts per 60 seconds (reasonable limit)
   - After limit: supervisor enters passive mode
   - Manual intervention required to recover

2. **Monitoring**:
   - OTEL alerts if restart rate >3/min
   - Log restart events with reason
   - Dashboard shows per-bulkhead restart rate

3. **Fallback Options**:
   - If restart storm detected: Mark bulkhead unhealthy, move load
   - Drain connections from bad bulkhead
   - Manual restart trigger for ops

4. **Acceptance Criteria**:
   - Bulkhead crash doesn't cascade to sibling bulkheads
   - Restart limits respected
   - System stays up during restart storms

**Owner**: Agent 4 (system-architect)
**Timeline**: Day 1 PM (parallel with Agents 2-3)
**Evidence Required**: Restart metrics, cascade isolation test results

---

#### MR-2: Security Fuzzing Finds Unexpected Crash
**Workstream**: Agent 8 (Security Hardening)
**Risk Level**: MEDIUM
**Probability**: MEDIUM (25%)
**Impact**: MEDIUM (security vulnerability found late)
**Trigger Events**:
- Fuzz test crashes URI parser
- Unexpected input causes memory corruption
- UTF-8 validation insufficient

**Mitigation Strategy**:
1. **During Agent 8 Implementation**:
   - Use standard URI parser (don't reinvent wheel)
   - Leverage `uri_string` module (Erlang stdlib)
   - Test against OWASP URI fuzzing corpus

2. **Fuzzing Strategy**:
   - AFL or libFuzzer with 10K inputs
   - Property-based testing with Proper
   - Unicode fuzzing (homoglyphs, combining chars)

3. **Fallback Options**:
   - If crash found: Implement workaround, create unit test
   - Request Erlang/OTP fix if stdlib issue
   - Sandbox URI parsing in separate process

4. **Acceptance Criteria**:
   - 0 crashes on 10K fuzz inputs (target)
   - 0-1 crashes acceptable with fix + test

**Owner**: Agent 8 (production-validator)
**Timeline**: Day 2 AM (after Agents 6-7)
**Evidence Required**: Fuzz test results, crash dumps (if any), fixes applied

---

#### MR-3: SBOM Contains Unknown Vulnerability
**Workstream**: Agent 9 (Supply Chain)
**Risk Level**: MEDIUM
**Probability**: LOW (10%)
**Impact**: MEDIUM (blocks release or requires remediation)
**Trigger Events**:
- Dependency has HIGH/CRITICAL CVE
- CVE discovered after SBOM generated
- License compatibility issue found

**Mitigation Strategy**:
1. **Pre-SBOM Audit**:
   - Check each dependency for known CVEs
   - Verify license compatibility (Apache 2.0 OK, GPL NOT OK)
   - Use snyk or grype scanning

2. **During Agent 9**:
   - Generate SBOM with current vulnerability DB
   - Scan again with latest DB
   - Document scan date and tool version

3. **Fallback Options**:
   - If CVE found: Evaluate severity
   - Low/Medium: Document and proceed (with monitoring)
   - High/Critical: Bump dependency version or find alternative
   - License issue: Replace dependency or get waiver

4. **Acceptance Criteria**:
   - 0 HIGH/CRITICAL vulnerabilities (hard stop)
   - 0-2 MEDIUM vulnerabilities acceptable with monitoring

**Owner**: Agent 9 (production-validator)
**Timeline**: Day 2 PM (final phase)
**Evidence Required**: SBOM, vulnerability scan report, remediation plan

---

#### MR-4: Evidence Aggregation Reveals Major Gap
**Workstream**: Agent 10 (Evidence Bundle)
**Risk Level**: MEDIUM
**Probability**: MEDIUM (30%)
**Impact**: MEDIUM (requires rework or scope reduction)
**Trigger Events**:
- Final evidence bundle shows one agent failing
- Missing test coverage for critical path
- Regression test fails

**Mitigation Strategy**:
1. **Daily Evidence Sync**:
   - Agents report evidence artifacts daily
   - Aggregate into provisional bundle
   - Catch issues early

2. **During Agent 10**:
   - Validate bundle against schema
   - Cross-check all acceptance criteria
   - Identify any gaps immediately

3. **Fallback Options**:
   - Gap in Agent X: Request emergency extension (4 hours)
   - Partial evidence: Document limitation in release notes
   - Missing acceptance: Escalate to go/no-go decision

4. **Acceptance Criteria**:
   - All 10 agents report "evidence complete"
   - Bundle validates against schema
   - All acceptance criteria met (0 failures)

**Owner**: Agent 10 (docs-writer)
**Timeline**: Day 2 evening (before release)
**Evidence Required**: Bundle validation report

---

#### MR-5: Test Suite Execution Blocked (Build System)
**Workstream**: All agents
**Risk Level**: MEDIUM
**Probability**: MEDIUM (30%)
**Impact**: MEDIUM (blocks validation, extends timeline)
**Trigger Events**:
- rebar3 crash (like in benchmark summary)
- EUnit test runner issue
- Dialyzer false positives

**Mitigation Strategy**:
1. **Pre-Flight Check** (Day 1, 7 AM):
   - Run `rebar3 compile` on clean build
   - Run `rebar3 eunit` on simple test
   - If fails: Fix before spawning agents

2. **Fallback Build System**:
   - Have Makefile with erlc rules ready
   - Can run tests without rebar3 if needed
   - Direct escript invocation for benchmarks

3. **During Testing**:
   - Monitor for test runner failures
   - Have alternative test execution paths
   - Build artifacts incrementally

4. **Acceptance Criteria**:
   - Tests execute without build system errors
   - Can run tests in multiple ways (rebar3, Makefile, direct erlc)

**Owner**: All agents (shared concern)
**Timeline**: Day 1, 7 AM (critical blocker if not fixed)
**Evidence Required**: Build system validation report

---

#### MR-6: Load Test Hardware Insufficient
**Workstream**: Agent 5 (Registry Scaling)
**Risk Level**: MEDIUM
**Probability**: LOW (15%)
**Impact**: MEDIUM (scaling test inconclusive)
**Trigger Events**:
- 100K connections exceeds available memory
- CPU maxes out, can't add more load
- Network saturation reached before software limit

**Mitigation Strategy**:
1. **Pre-Load Testing**:
   - Reserve hardware (16+ cores, 32GB+ RAM)
   - Verify Docker/container memory limits not blocking
   - Baseline: 50K connections test first

2. **During Agent 5**:
   - Monitor memory, CPU, network during ramp-up
   - Stop if hardware limit reached
   - Document hardware constraints

3. **Fallback Options**:
   - Test to 50K connections (still significant scale)
   - Use distributed test (multiple machines)
   - Cloud-based load generation (AWS, GCP)

4. **Acceptance Criteria**:
   - Can reach 50K connections minimum (required)
   - Can reach 100K connections (target)
   - Results document hardware constraints

**Owner**: Agent 5 (code-analyzer)
**Timeline**: Day 2 AM (reserved hardware check)
**Evidence Required**: Hardware capacity report, scaling curve

---

#### MR-7: Lifecycle Cleanup Interferes with Normal Operations
**Workstream**: Agent 7 (Lifecycle Cleanup)
**Risk Level**: MEDIUM
**Probability**: LOW (20%)
**Impact**: MEDIUM (background job causes latency spikes)
**Trigger Events**:
- Cleanup job runs during peak load
- ETS table lock during cleanup causes pause
- Cleanup frequency too aggressive

**Mitigation Strategy**:
1. **During Agent 7 Design**:
   - Cleanup job runs off-peak (configurable schedule)
   - Uses batch processing (1000 at a time) to avoid long locks
   - Yielding between batches (scheduler gets CPU)

2. **Testing**:
   - Run load test while cleanup active
   - Measure latency impact during cleanup
   - Verify cleanup doesn't block operations

3. **Fallback Options**:
   - Reduce cleanup frequency (every 2 minutes instead of 1)
   - Reduce batch size (500 instead of 1000)
   - Skip cleanup during peak hours (manual trigger)

4. **Acceptance Criteria**:
   - Cleanup doesn't increase p99 latency >10% (target)
   - Cleanup doesn't increase p99 latency >20% (acceptable)
   - Cleanup latency <100ms per batch

**Owner**: Agent 7 (tester)
**Timeline**: Day 1 PM (after Agent 6)
**Evidence Required**: Latency impact test results

---

#### MR-8: Protocol Safety Changes Break Existing Clients
**Workstream**: Agent 6 (Protocol Safety)
**Risk Level**: MEDIUM
**Probability**: LOW (15%)
**Impact**: MEDIUM (backward compatibility issue)
**Trigger Events**:
- Strict init enforcement breaks client code
- Existing apps expect lenient behavior
- Backward compat not planned

**Mitigation Strategy**:
1. **During Agent 6 Design**:
   - Implement deprecation path (warn in v1.2, error in v1.3)
   - Provide migration guide in release notes
   - Offer optional "lenient mode" config

2. **Testing**:
   - Test against real client code (if available)
   - Ensure error messages are clear
   - Verify deprecation notices work

3. **Fallback Options**:
   - Add `{strict_mode, false}` config option
   - Delay strict enforcement to v1.4
   - Provide compatibility shim module

4. **Acceptance Criteria**:
   - Error messages are clear + actionable
   - Migration path documented
   - Existing correct code continues to work

**Owner**: Agent 6 (tester)
**Timeline**: Day 1 AM (parallel with Agent 1)
**Evidence Required**: Client compatibility test results

---

### LOW RISKS

#### LR-1: Transport Optimization Causes Regression
**Workstream**: Agent 1
**Risk Level**: LOW
**Probability**: LOW (10%)
**Impact**: LOW (revert to baseline)

---

#### LR-2: OTEL Instrumentation Overhead Exceeds Budget
**Workstream**: All agents
**Risk Level**: LOW
**Probability**: LOW (10%)
**Impact**: LOW (disable tracing if needed)

---

#### LR-3: Documentation/Whitepaper Quality Issues
**Workstream**: Agent 10
**Risk Level**: LOW
**Probability**: MEDIUM (30%)
**Impact**: LOW (rework or supplement)

---

#### LR-4: Test Coverage Calculation Inaccuracy
**Workstream**: All agents
**Risk Level**: LOW
**Probability**: MEDIUM (25%)
**Impact**: LOW (recount and revalidate)

---

#### LR-5: Supply Chain Artifacts Don't Validate Against Schema
**Workstream**: Agent 9
**Risk Level**: LOW
**Probability**: LOW (15%)
**Impact**: LOW (fix schema or artifacts)

---

#### LR-6: Regression Test Suite Becomes Too Slow
**Workstream**: All agents
**Risk Level**: LOW
**Probability**: MEDIUM (25%)
**Impact**: LOW (parallelize or optimize)

---

## RISK RESPONSE MATRIX

| Risk | Trigger | Owner | Action | Timeline |
|------|---------|-------|--------|----------|
| CR-1 (GC Pause) | GC pause >50ms | Agent 1 | Switch to plan B (80K target) | Immediate |
| HR-1 (Registry) | p99 >1ms | Agent 5 | Increase shards to 32 | Immediate |
| HR-2 (Circuit) | Recovery >5min | Agent 3 | Reduce OPEN timeout to 30s | Immediate |
| HR-3 (Backpressure) | p99 >100ms | Agent 2 | Cap backoff at 50ms | Immediate |
| MR-1 (Bulkhead) | Restart rate >3/min | Agent 4 | Alert + drain connections | Immediate |
| MR-2 (Security) | Fuzz crash | Agent 8 | Implement fix + test | 1 hour |
| MR-3 (SBOM) | CVE found | Agent 9 | Bump dependency or waiver | 1 hour |
| MR-4 (Evidence) | Gap found | Agent 10 | Emergency extension for agent | 4 hours |
| MR-5 (Build) | Test fails | All | Switch to Makefile | Immediate |
| MR-6 (Hardware) | Can't reach 50K | Agent 5 | Cloud load generation | 2 hours |
| MR-7 (Cleanup) | p99 +20% | Agent 7 | Reduce batch size to 500 | Immediate |
| MR-8 (Protocol) | Client breaks | Agent 6 | Enable lenient mode option | 1 hour |

---

## AGENT ASSIGNMENT DETAILS

### Agent 1: Transport Ceiling (performance-benchmarker)

**Agent Type**: Performance Benchmarker
**Experience Required**: Erlang benchmarking, systems performance, CPU profiling
**Time Commitment**: 4-5 hours
**Expertise Areas**:
- CPU profiling tools (percept, recon)
- Throughput measurement methodology
- Latency distribution analysis
- GC impact assessment

**Pre-Requisites**:
- Access to reference hardware (16+ cores)
- OTEL collector running
- Baseline measurements from v0.6.0
- GC tuning parameters from v1.2.0 docs

**Deliverables**:
1. Optimized transport implementation (TCP_NODELAY + buffer tuning)
2. Benchmark harness: `bench/benchmark_4kb_ceiling.erl`
3. Throughput report: JSON with detailed latency histogram
4. OTEL traces showing hot paths
5. GC analysis report

**Success Criteria**:
- Throughput ≥95K msg/sec on 4KB payloads
- OR acceptable fallback 80K msg/sec with documented constraints
- p99 latency <2ms
- Zero throughput regressions

---

### Agent 2: Bounded Backpressure (backend-dev)

**Agent Type**: Backend Developer
**Experience Required**: OTP gen_server, state machines, flow control
**Time Commitment**: 6 hours
**Expertise Areas**:
- Queue management
- State machine design
- Error handling patterns
- Integration with existing systems

**Pre-Requisites**:
- Agent 1 throughput baseline (locked)
- Design review: queue cap = 1000 messages (configurable)
- Backpressure events design
- OTEL integration points

**Deliverables**:
1. Core module: `src/erlmcp_backpressure.erl`
2. Header: `include/erlmcp_backpressure.hrl`
3. Test suite: `test/erlmcp_backpressure_tests.erl`
4. Integration code: Modifications to erlmcp_server/client for backpressure handling
5. OTEL instrumentation for backpressure events

**Success Criteria**:
- Queue size never exceeds configured max ±10%
- Memory growth stable under sustained overload
- Backpressure signal propagates <100ms
- 100% queue cap enforcement in tests

---

### Agent 3: Circuit Breaker (system-architect)

**Agent Type**: System Architect
**Experience Required**: OTP patterns, fault tolerance, distributed systems
**Time Commitment**: 4 hours
**Expertise Areas**:
- Circuit breaker patterns (SRE model)
- State machine correctness
- Failure detection algorithms
- Recovery timing strategies

**Pre-Requisites**:
- Decision: SRE circuit breaker pattern (CLOSED → OPEN → HALF_OPEN → CLOSED)
- Agent 2 backpressure interface (for feedback integration)
- Configuration schema: threshold=5, window=30s, timeout=60s
- OTEL event design

**Deliverables**:
1. Core module: `src/erlmcp_circuit_breaker.erl`
2. Header: `include/erlmcp_circuit_breaker.hrl`
3. Test suite: `test/erlmcp_circuit_breaker_tests.erl`
4. State machine documentation (diagrams + pseudocode)
5. OTEL instrumentation for circuit breaker events

**Success Criteria**:
- Retry storms blocked: max 5 retries within 30s window
- Recovery time: <60s start, <5s after service healthy again
- State transitions: 100% correctness in property tests
- Zero unwanted state loops

---

### Agent 4: Bulkheads (system-architect)

**Agent Type**: System Architect
**Experience Required**: OTP supervision, failure isolation, system design
**Time Commitment**: 5 hours
**Expertise Areas**:
- Supervisor hierarchies
- Failure domain design
- Process isolation patterns
- Restart strategy tuning

**Pre-Requisites**:
- Decision: Fixed 8 bulkheads (hash-based routing)
- Current supervision tree from v0.6.0
- Bulkhead config: restart_intensity=5, restart_period=60s
- Integration plan with Agents 2-3

**Deliverables**:
1. Enhanced supervisor: `src/erlmcp_sup_v13.erl`
2. Bulkhead modules: `src/erlmcp_bulkhead_*.erl` (per transport type)
3. Header: `include/erlmcp_bulkhead.hrl`
4. Test suite: `test/erlmcp_bulkhead_isolation_tests.erl`
5. Supervision tree diagram (updated)

**Success Criteria**:
- Single connection crash: doesn't affect other connections
- Transport subsystem crash: doesn't crash all clients/servers
- Crash propagation: contained at bulkhead boundary
- Bulkhead restart times: <2s per restart

---

### Agent 5: Registry Scaling @ 100K (code-analyzer)

**Agent Type**: Code Analyzer
**Experience Required**: Systems analysis, benchmarking, ETS, contention analysis
**Time Commitment**: 5 hours
**Expertise Areas**:
- ETS performance tuning
- Contention measurement
- Scalability analysis
- Load testing methodology

**Pre-Requisites**:
- Decision: Registry sharding with 16 shards
- Agents 2-4 complete (backpressure + bulkheads ready)
- Existing `erlmcp_registry_sharded.erl` module
- Load generation harness (or use existing from v0.6.0)
- Hardware: 16+ cores, 32GB RAM, or Docker environment

**Deliverables**:
1. 100K scale benchmark: `bench/benchmark_100k_registry.erl`
2. Contention analyzer: `src/erlmcp_registry_analyzer.erl`
3. Scaling report: JSON with latency vs connections graph
4. Capacity planning guide (connections per node, shard limits)
5. OTEL traces showing contention hot spots

**Success Criteria**:
- Registry p99 lookup <1ms at 100K connections
- Linear or sub-linear memory scaling
- GC pause stable (not spiking at scale)
- No surprise lockups or contention issues

---

### Agent 6: Protocol Safety (tester)

**Agent Type**: Tester (QA Engineer)
**Experience Required**: Protocol validation, state machine testing, negative testing
**Time Commitment**: 4 hours
**Expertise Areas**:
- MCP protocol specification
- State machine verification
- Error condition testing
- Property-based testing (Proper)

**Pre-Requisites**:
- MCP protocol spec (initialization requirements)
- Decision: Strict init enforcement (error if pre-init operation attempted)
- Client state machine definitions
- Test framework setup (EUnit + Proper)

**Deliverables**:
1. Test suite: `test/erlmcp_protocol_safety_tests.erl`
2. State machine validator: `src/erlmcp_protocol_validator.erl`
3. Request ID audit tool: `src/erlmcp_request_id_auditor.erl`
4. Protocol compliance report: JSON with test results
5. Edge case documentation

**Success Criteria**:
- 100% of pre-init operations rejected
- 100% of protocol mismatches detected
- Request ID collision rate: 0/10M samples
- Initialization timeout enforced ±5%

---

### Agent 7: Lifecycle Cleanup (tester)

**Agent Type**: Tester
**Experience Required**: Resource cleanup patterns, ETS, background tasks
**Time Commitment**: 4 hours
**Expertise Areas**:
- TTL implementation
- Background job design
- Memory leak detection
- Cleanup correctness verification

**Pre-Requisites**:
- Agent 6 initialization state machine (must work first)
- Decision: Hybrid cleanup (explicit + TTL fallback)
- TTL configuration: subscription_ttl_ms=300000, task_ttl_ms=3600000
- Cleanup job design: interval=60s, batch_size=1000

**Deliverables**:
1. Test suite: `test/erlmcp_lifecycle_cleanup_tests.erl`
2. Cleanup job: `src/erlmcp_cleanup_manager.erl`
3. Handler audit tool: `src/erlmcp_handler_auditor.erl`
4. Cleanup report: JSON with handler leak analysis
5. TTL enforcement verification

**Success Criteria**:
- Zero handler leaks after unsubscribe()
- Task cleanup 100% completion within TTL
- Session cleanup completes <5s
- Handler accumulation stays bounded <1000

---

### Agent 8: Security Hardening (production-validator)

**Agent Type**: Production Validator
**Experience Required**: Security testing, URI validation, fuzzing, OWASP
**Time Commitment**: 5 hours
**Expertise Areas**:
- Security vulnerability patterns
- URI/path traversal attacks
- Fuzzing methodologies
- OWASP attack validation

**Pre-Requisites**:
- Decision: Strict URI validation (canonicalization + whitelist)
- Security requirements doc (Attack types to block)
- Fuzzing corpus (OWASP patterns)
- Agent 4 bulkhead isolation (for contained testing)

**Deliverables**:
1. URI validator: `src/erlmcp_uri_validator.erl`
2. Header validator: `src/erlmcp_header_validator.erl`
3. Test suite: `test/erlmcp_security_tests.erl`
4. Fuzzing results: JSON with attack statistics
5. Security audit report

**Success Criteria**:
- 100/100 traversal attacks blocked
- 50/50 header injection attacks blocked
- 0 crashes on 10K fuzz inputs
- 0 HIGH/CRITICAL vulnerabilities in code

---

### Agent 9: Supply Chain Artifacts (production-validator)

**Agent Type**: Production Validator
**Experience Required**: SBOM generation, vulnerability scanning, compliance
**Time Commitment**: 2-3 hours
**Expertise Areas**:
- CycloneDX format
- Vulnerability databases
- License compliance
- Build reproducibility

**Pre-Requisites**:
- Decision: CycloneDX JSON format + Grype scanning
- Dependency list from rebar3
- Build artifacts from all agents
- Vulnerability database access (Grype or Snyk)

**Deliverables**:
1. SBOM: `docs/v1.3.0-SBOM.cyclonedx` (CycloneDX JSON)
2. Vulnerability scan: `docs/v1.3.0-VULNERABILITY-SCAN.json`
3. License compliance: `docs/v1.3.0-LICENSE-COMPLIANCE.json`
4. Provenance attestation: `docs/v1.3.0-PROVENANCE.attestation`
5. Supply chain report: `docs/v1.3.0-SUPPLY-CHAIN-REPORT.md`

**Success Criteria**:
- SBOM: 100% dependencies documented
- Vulnerabilities: 0 HIGH/CRITICAL
- Licenses: All compatible with Apache 2.0
- Reproducibility: Bit-for-bit match on rebuild

---

### Agent 10: Evidence Aggregation + CTO Whitepaper (docs-writer)

**Agent Type**: Documentation Writer
**Experience Required**: Technical writing, architecture documentation, evidence synthesis
**Time Commitment**: 4 hours
**Expertise Areas**:
- System architecture communication
- Evidence aggregation
- CTO-level audience (non-technical stakeholders)
- Release notes + deployment guides

**Pre-Requisites**:
- All 9 agents' deliverables (evidence artifacts)
- Evidence schema (JSON + validation)
- CTO whitepaper outline
- Release notes template

**Deliverables**:
1. Evidence bundle: `docs/v1.3.0-EVIDENCE-BUNDLE.json`
2. Bundle validator: `src/erlmcp_evidence_validator.erl`
3. CTO whitepaper: `docs/v1.3.0-CTO-WHITEPAPER.md`
4. Release notes: `docs/v1.3.0-RELEASE-NOTES.md`
5. Deployment checklist: `docs/v1.3.0-DEPLOYMENT-CHECKLIST.md`

**Success Criteria**:
- Bundle validates against schema
- All 10 agents' evidence present
- CTO whitepaper: 5-10 pages, clear narrative
- Release notes: Clear, technical, ready for customers
- Deployment checklist: Comprehensive, executable

---

## AGENT SPAWNING CHECKLIST

### Day 1, 7:00 AM - Pre-Flight (MANDATORY)

- [ ] Reserve hardware: 16+ cores, 32GB RAM, or container with limits
- [ ] Verify build system: `rebar3 compile` works
- [ ] Baseline benchmark: v0.6.0 at 42.6K msg/sec
- [ ] GC tuning loaded: from v1.2.0 docs
- [ ] OTEL collector running: jaeger or similar
- [ ] Decision approval: All 10 decisions signed off
- [ ] Config schema: `include/erlmcp_v13_config.hrl` ready

### Day 1, 8:00 AM - SPAWN PHASE 1

- [ ] **Spawn Agent 1** (performance-benchmarker): Transport ceiling
- [ ] **Spawn Agent 6** (tester): Protocol safety (parallel, no dependencies)
- [ ] Timeline: Both agents target 4-hour completion (12 PM)

### Day 1, 12:00 PM - Handoff Phase 1 → Phase 2

- [ ] Verify Agent 1: Throughput baseline locked (≥80K msg/sec)
- [ ] Verify Agent 6: Protocol safety tests pass (100% pre-init rejection)
- [ ] Collect evidence artifacts from both agents

### Day 1, 1:00 PM - SPAWN PHASE 2

- [ ] **Spawn Agent 2** (backend-dev): Backpressure
- [ ] **Spawn Agent 3** (system-architect): Circuit breaker
- [ ] **Spawn Agent 4** (system-architect): Bulkheads
- [ ] **Spawn Agent 7** (tester): Lifecycle cleanup
- [ ] Timeline: All agents target 5-6 hour completion (6-7 PM)

### Day 1, 7:00 PM - Daily Standup #1

- [ ] Status check: All Phase 2 agents on track
- [ ] Identify blockers: Escalate if needed
- [ ] Adjust timeline if slipping

### Day 2, 8:00 AM - Handoff Phase 2 → Phase 3

- [ ] Verify Agents 2-4: Backpressure, circuit, bulkheads working
- [ ] Verify Agent 7: Lifecycle cleanup tests pass
- [ ] Collect evidence artifacts

### Day 2, 9:00 AM - SPAWN PHASE 3

- [ ] **Spawn Agent 5** (code-analyzer): Registry scaling @ 100K
- [ ] **Spawn Agent 8** (production-validator): Security hardening
- [ ] Timeline: Both agents target 5 hour completion (2 PM)

### Day 2, 2:00 PM - Daily Standup #2

- [ ] Status check: Agents 5-8 progress
- [ ] Monitor: 100K scaling test (watch for memory/CPU limits)
- [ ] Identify any security findings from Agent 8

### Day 2, 3:00 PM - Handoff Phase 3 → Phase 4

- [ ] Verify Agent 5: 100K registry scaling <1ms p99
- [ ] Verify Agent 8: Security audit complete, 0 CVEs
- [ ] Collect evidence artifacts

### Day 2, 4:00 PM - SPAWN PHASE 4

- [ ] **Spawn Agent 9** (production-validator): Supply chain
- [ ] **Spawn Agent 10** (docs-writer): Evidence bundle
- [ ] Timeline: Agent 9 = 2 hours (6 PM), Agent 10 = 3 hours (7 PM)

### Day 2, 6:00 PM - Daily Standup #3

- [ ] Status check: SBOM generation + vulnerability scan
- [ ] Monitor: Any CVEs found → escalate if needed

### Day 2, 7:00 PM - Final Validation

- [ ] **CRITICAL**: Validate evidence bundle against schema
- [ ] **CRITICAL**: All 10 agents report evidence complete
- [ ] **CRITICAL**: Go/No-Go decision point

### Day 2, 8:00 PM - Final Checks

- [ ] Code review: All changes compile + type check
- [ ] Test coverage: All suites pass, 80%+ overall
- [ ] Dialyzer: 0 warnings
- [ ] xref: 0 undefined functions

### Day 2, 9:00 PM - Release Build

- [ ] Build v1.3.0 release artifact
- [ ] Generate SBOM
- [ ] Tag git commit
- [ ] Document release notes

### Day 3, 9:00 AM - Post-Release

- [ ] Deploy to staging environment
- [ ] Run smoke tests (100 connections, basic operations)
- [ ] Monitor: Throughput, latency, error rate
- [ ] Customer notification: Release announcement

---

## SUCCESS METRICS SUMMARY

| Metric | Target | Acceptable | Fail |
|--------|--------|-----------|------|
| Throughput (4KB) | ≥95K msg/sec | 80-95K msg/sec | <80K msg/sec |
| Latency p99 | <2ms | <5ms | ≥5ms |
| Queue overflow | 0% | 0% | >0% |
| Crash propagation | 0% | 0% | >0% |
| Registry p99 @ 100K | <1ms | <2ms | ≥2ms |
| Protocol safety | 100% | 100% | <100% |
| Handler leaks | 0 | 0 | >0 |
| Security attacks blocked | 100/100 | 100/100 | <100 |
| CVE HIGH/CRITICAL | 0 | 0 | >0 |
| Evidence complete | 10/10 | 10/10 | <10 |

---

## FINAL DECISION GATE

**Go/No-Go Criteria** (ALL must be true):
- [ ] Agent 1: Throughput ≥80K msg/sec (acceptable minimum)
- [ ] Agent 2: Queue caps enforced, memory stable
- [ ] Agent 3: Circuit breaker recovery <5 minutes
- [ ] Agent 4: Zero crash propagation between connections
- [ ] Agent 5: Registry scales to at least 50K (100K is target)
- [ ] Agent 6: 100% protocol safety enforcement
- [ ] Agent 7: Zero handler leaks after cleanup
- [ ] Agent 8: 0 HIGH/CRITICAL security CVEs
- [ ] Agent 9: SBOM complete, 0 major vulnerabilities
- [ ] Agent 10: Evidence bundle validates, CTO whitepaper complete

**Default Decision**: GO (proceed to release) if all criteria met
**Escalation**: Any single criterion missed → escalate for manager decision

---

**Ready to spawn agents upon final approval.**

