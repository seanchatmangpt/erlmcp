## Name of the node
-name erlmcp@127.0.0.1

## Cookie for distributed node communication
## Cookie MUST be set via ERLANG_COOKIE environment variable
## DO NOT hardcode cookies in this file - security vulnerability
# Cookie is set via -setcookie flag passed from environment

## Heartbeat management; auto-restarts VM if it dies or becomes unresponsive
-heart

## Enable kernel poll
+K true

## VM port limit for increased connection capacity
## Default: 24575 (~12K connections)
## New: 65535 (~32K connections with headroom)
+Q 65536

## Increase number of concurrent ports/sockets
## Supports up to 65K concurrent connections (TCP ports, files, external processes)
## Note: +Q flag above sets VM internal limit; this sets environment variable
-env ERL_MAX_PORTS 65536

## Increase number of processes
## Supports up to 262K concurrent processes (connections + workers + supervisors)
+P 262144

## Increase atom table size
+t 5000000

## Enable time correction
+c true

## Set scheduler bind type
+sbt db

## Enable busy wait for better latency
+sbwt very_short

## Async thread pool size
+A 64

## Max ETS tables
-env ERL_MAX_ETS_TABLES 50000

## Enable microstate accounting
+Muacul true

## Enable scheduler utilization balancing
+sub true

## Distribution buffer busy limit (KB)
+zdbbl 8192

## Set the logger burst limit
-kernel logger_burst_limit 5000

## Enable more detailed crash dumps
-env ERL_CRASH_DUMP_SECONDS 10

## Path to crash dumps
-env ERL_CRASH_DUMP ./logs/erl_crash.dump

## Enable system monitor
-env ERLMCP_SYSTEM_MONITOR true

## Memory allocator settings for better performance
+MBas aobf
+MBlmbcs 512
+MBsmbcs 1024
+MBsbct 2048

%% Cgroups-aware memory detection (OTP 26+)
%% +MBacul 0: Disable carrier utilization limit for cgroups v2
%% +Msbagf 512: Set carrier size alignment to 512 bytes
%% +MBacgs 0: Auto-detect cgroups memory limits
+MBacul 0
+Msbagf 512
+MBacgs 0

## Garbage collection settings
+hms 46422
+hmbs 46422