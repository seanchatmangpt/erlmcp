%%%-----------------------------------------------------------------------------
%%% @doc TCPS Generated Type Definitions
%%% @copyright 2026 TCPS Development Team
%%% @version 1.0.0
%%%
%%% THIS FILE IS AUTO-GENERATED from TCPS ontology
%%% DO NOT EDIT MANUALLY - Changes will be overwritten
%%% Generated by: ggen v6.0.0
%%% Source: ontology/tcps_core.ttl
%%% Timestamp: 2026-01-29T06:45:00Z
%%% Checksum: SHA256:f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9
%%% @end
%%%-----------------------------------------------------------------------------

-ifndef(TCPS_GENERATED_TYPES_HRL).
-define(TCPS_GENERATED_TYPES_HRL, true).

%%%=============================================================================
%%% Type Definitions from TCPS Ontology
%%%=============================================================================

%% SKU - Stock Keeping Unit (Marketplace Offering)
%% Source: tcps-core:SKU
-type sku_id() :: binary().
-type sku_version() :: {Major :: non_neg_integer(),
                        Minor :: non_neg_integer(),
                        Patch :: non_neg_integer()}.
-type sku_status() :: ready | pending | discontinued | deprecated.
-type sku_category() :: mcp_server | library | cli_tool | transport | plugin.

-record(sku, {
    id :: sku_id(),                      % Unique SKU identifier
    name :: binary(),                    % Human-readable name
    version :: sku_version(),            % Semantic version
    status :: sku_status(),              % Current status
    category :: sku_category(),          % Product category
    description :: binary(),             % Product description
    dependencies :: [sku_id()],          % Required dependencies
    created_at :: calendar:datetime(),   % Creation timestamp
    updated_at :: calendar:datetime()    % Last update timestamp
}).

-type sku() :: #sku{}.

%% WorkOrder - Pull-Based Production Demand
%% Source: tcps-core:WorkOrder
-type work_order_id() :: binary().
-type work_order_status() :: pending | in_progress | completed | failed | cancelled.
-type work_order_priority() :: critical | high | normal | low.

-record(work_order, {
    id :: work_order_id(),               % Unique work order ID
    sku_id :: sku_id(),                  % Target SKU to produce
    status :: work_order_status(),       % Current status
    priority :: work_order_priority(),   % Priority level
    requested_by :: binary(),            % Requester identifier
    requested_at :: calendar:datetime(), % Request timestamp
    started_at :: calendar:datetime() | undefined,   % Start time
    completed_at :: calendar:datetime() | undefined, % Completion time
    stages :: [production_stage()],      % Production stages
    receipts :: [receipt_id()]           % Generated receipts
}).

-type work_order() :: #work_order{}.

%% ProductionStage - Manufacturing Pipeline Step
%% Source: tcps-core:ProductionStage
-type stage_id() :: binary().
-type stage_name() :: compile | test | lint | benchmark | release | publish.
-type stage_status() :: pending | running | completed | failed | skipped.

-record(production_stage, {
    id :: stage_id(),                    % Unique stage ID
    name :: stage_name(),                % Stage name
    status :: stage_status(),            % Current status
    work_order_id :: work_order_id(),    % Parent work order
    slo_time_budget_ms :: pos_integer(), % SLO time budget (ms)
    actual_time_ms :: non_neg_integer(), % Actual execution time
    started_at :: calendar:datetime() | undefined,
    completed_at :: calendar:datetime() | undefined,
    inputs :: [artifact()],              % Input artifacts
    outputs :: [artifact()],             % Output artifacts
    receipt_id :: receipt_id() | undefined % Generated receipt
}).

-type production_stage() :: #production_stage{}.

%% Receipt - Deterministic Evidence of Work
%% Source: tcps-core:Receipt
-type receipt_id() :: binary().
-type checksum() :: binary().
-type checksum_algorithm() :: sha256 | sha512.

-record(receipt, {
    id :: receipt_id(),                  % Unique receipt ID
    stage_id :: stage_id(),              % Production stage
    work_order_id :: work_order_id(),    % Parent work order
    timestamp :: calendar:datetime(),    % Generation timestamp (UTC)
    success :: boolean(),                % Success indicator
    metrics :: map(),                    % Performance metrics
    checksum :: checksum(),              % Cryptographic checksum
    checksum_algorithm :: checksum_algorithm(), % Hash algorithm used
    inputs :: [artifact()],              % Input checksums
    outputs :: [artifact()],             % Output checksums
    deterministic :: boolean()           % Reproducibility flag
}).

-type receipt() :: #receipt{}.

%% Andon - Quality Alert/Signal
%% Source: tcps-core:AndonEvent
-type andon_id() :: binary().
-type andon_severity() :: critical | warning | info.
-type andon_color() :: red | yellow | green.

-record(andon_event, {
    id :: andon_id(),                    % Unique event ID
    severity :: andon_severity(),        % Severity level
    color :: andon_color(),              % Visual signal (ðŸ”´/ðŸŸ¡/ðŸŸ¢)
    message :: binary(),                 % Event message
    stage_id :: stage_id() | undefined,  % Related stage
    work_order_id :: work_order_id() | undefined, % Related work order
    timestamp :: calendar:datetime(),    % Event timestamp
    resolved :: boolean(),               % Resolution status
    resolved_at :: calendar:datetime() | undefined % Resolution time
}).

-type andon_event() :: #andon_event{}.

%% Artifact - Build Input/Output
-type artifact_type() :: source_file | beam_file | release | documentation | test_report.
-type artifact() :: #{
    name := binary(),
    type := artifact_type(),
    path := binary(),
    checksum := checksum(),
    size_bytes := non_neg_integer()
}.

%% QualityGate - Quality Threshold Check
-type quality_gate() :: #{
    name := binary(),
    criteria := binary(),
    threshold := number(),
    actual := number(),
    passed := boolean(),
    severity := critical | warning
}.

%% Metrics - Performance Measurements
-type metrics() :: #{
    duration_ms => non_neg_integer(),
    throughput_ops_per_sec => number(),
    memory_bytes => non_neg_integer(),
    cpu_percent => number(),
    success_rate => float(),
    error_count => non_neg_integer()
}.

%%%=============================================================================
%%% Validation Functions
%%%=============================================================================

%% @doc Validate SKU record
-spec validate_sku(sku()) -> ok | {error, term()}.
validate_sku(#sku{id = Id, version = {Maj, Min, Pat}})
  when is_binary(Id), is_integer(Maj), is_integer(Min), is_integer(Pat),
       Maj >= 0, Min >= 0, Pat >= 0 ->
    ok;
validate_sku(_) ->
    {error, invalid_sku}.

%% @doc Validate WorkOrder record
-spec validate_work_order(work_order()) -> ok | {error, term()}.
validate_work_order(#work_order{id = Id, sku_id = SkuId})
  when is_binary(Id), is_binary(SkuId) ->
    ok;
validate_work_order(_) ->
    {error, invalid_work_order}.

%% @doc Validate Receipt record
-spec validate_receipt(receipt()) -> ok | {error, term()}.
validate_receipt(#receipt{id = Id, checksum = Checksum, deterministic = Det})
  when is_binary(Id), is_binary(Checksum), is_boolean(Det) ->
    ok;
validate_receipt(_) ->
    {error, invalid_receipt}.

%%%=============================================================================
%%% Constructor Functions
%%%=============================================================================

%% @doc Create a new SKU
-spec new_sku(sku_id(), binary(), sku_version()) -> sku().
new_sku(Id, Name, Version) ->
    Now = calendar:universal_time(),
    #sku{
        id = Id,
        name = Name,
        version = Version,
        status = pending,
        category = library,
        description = <<>>,
        dependencies = [],
        created_at = Now,
        updated_at = Now
    }.

%% @doc Create a new WorkOrder
-spec new_work_order(work_order_id(), sku_id(), binary()) -> work_order().
new_work_order(Id, SkuId, RequestedBy) ->
    Now = calendar:universal_time(),
    #work_order{
        id = Id,
        sku_id = SkuId,
        status = pending,
        priority = normal,
        requested_by = RequestedBy,
        requested_at = Now,
        started_at = undefined,
        completed_at = undefined,
        stages = [],
        receipts = []
    }.

%% @doc Create a new Receipt
-spec new_receipt(receipt_id(), stage_id(), work_order_id()) -> receipt().
new_receipt(Id, StageId, WorkOrderId) ->
    Now = calendar:universal_time(),
    #receipt{
        id = Id,
        stage_id = StageId,
        work_order_id = WorkOrderId,
        timestamp = Now,
        success = false,
        metrics = #{},
        checksum = <<>>,
        checksum_algorithm = sha256,
        inputs = [],
        outputs = [],
        deterministic = true
    }.

-endif. % TCPS_GENERATED_TYPES_HRL
